{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/lekhu/Documents/David/Jobportal-Mobile-App/screens/profileStacks/user.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { ThemeContext } from \"../../contexts/ThemeContext\";\nimport AppText from \"../../shared/appText\";\nimport Icon from \"../../shared/icon\";\nimport { ScrollView, TouchableOpacity } from \"react-native-gesture-handler\";\nimport { ListItem } from \"react-native-elements\";\nimport { AuthContext } from \"../../contexts/AuthContext\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport Constants from \"expo-constants\";\nimport * as Permissions from \"expo-permissions\";\nimport { Asset } from \"expo-asset\";\nimport Axios from \"axios\";\nimport { images } from \"../../styles/globalStyles\";\nimport { apiPath } from \"../../utils/constants/Consts\";\nimport { serializeErrors } from \"../../utils/Helpers\";\n\nfunction User(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useContext = useContext(ThemeContext),\n      isThemeDark = _useContext.isThemeDark;\n\n  var _useContext2 = useContext(AuthContext),\n      authUser = _useContext2.authUser,\n      setUnauthStatus = _useContext2.setUnauthStatus,\n      updateAuthUserProfile = _useContext2.updateAuthUserProfile;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isSubmitting = _useState2[0],\n      setIsSubmitting = _useState2[1];\n\n  var defaultDPUri = Asset.fromModule(images.defaultProfile).uri;\n  useEffect(function () {\n    getPermissionAsync();\n  }, []);\n\n  var getPermissionAsync = function getPermissionAsync() {\n    var _await$Permissions$as, status;\n\n    return _regeneratorRuntime.async(function getPermissionAsync$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!Constants.platform.ios) {\n              _context.next = 6;\n              break;\n            }\n\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL));\n\n          case 3:\n            _await$Permissions$as = _context.sent;\n            status = _await$Permissions$as.status;\n\n            if (status !== \"granted\") {\n              alert(\"Sorry, we need camera roll permissions!\");\n            }\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _pickImage = function _pickImage() {\n    var result;\n    return _regeneratorRuntime.async(function _pickImage$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.All,\n              allowsEditing: true,\n              aspect: [1, 1],\n              quality: 1\n            }));\n\n          case 3:\n            result = _context2.sent;\n\n            if (result.cancelled) {\n              _context2.next = 6;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", result);\n\n          case 6:\n            _context2.next = 11;\n            break;\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 8]], Promise);\n  };\n\n  var handleDPChange = function handleDPChange() {\n    _pickImage().then(function (image) {\n      setIsSubmitting(true);\n      var photo = {\n        uri: image.uri,\n        type: \"image/png\",\n        name: \"xyz.png\"\n      };\n      var formData = new FormData();\n      formData.append(\"profile\", photo);\n\n      _uploadDisplayPicture(formData).then(function (user) {\n        if (!user) return;\n        updateAuthUserProfile(user.profile).then(function () {\n          alert(\"Successfully updated profile\");\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      }).then(function () {\n        return setIsSubmitting(false);\n      });\n    }).catch(function (error) {\n      console.log(error.response);\n    });\n  };\n\n  var _uploadDisplayPicture = function _uploadDisplayPicture(formData) {\n    var options, result;\n    return _regeneratorRuntime.async(function _uploadDisplayPicture$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            options = {\n              method: \"POST\",\n              url: apiPath + \"/jobseeker/edit-profile\",\n              data: formData,\n              headers: {\n                \"Accept\": \"application/json\",\n                \"Content-Type\": \"multipart/form-data;\"\n              }\n            };\n            _context3.prev = 1;\n            _context3.next = 4;\n            return _regeneratorRuntime.awrap(Axios(options).then(function (res) {\n              return res.data;\n            }));\n\n          case 4:\n            result = _context3.sent;\n\n            if (!(result.resp == 1)) {\n              _context3.next = 7;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", result.user);\n\n          case 7:\n            _context3.next = 12;\n            break;\n\n          case 9:\n            _context3.prev = 9;\n            _context3.t0 = _context3[\"catch\"](1);\n\n            if (Axios.isCancel(_context3.t0)) {\n              console.log(\"Request cancelled\");\n            } else if (_context3.t0.response) {\n              console.log(_context3.t0.response);\n              if (_context3.t0.response.status == 422) reportErrors(serializeErrors(_context3.t0.response.data));else if (_context3.t0.response.data.resp == 0) reportErrors(serializeErrors({\n                error: _context3.t0.response.data.message\n              }));else reportErrors(serializeErrors({\n                error: \"Failed to change profile picture\"\n              }));\n            } else {\n              console.log(_context3.t0);\n            }\n\n          case 12:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[1, 9]], Promise);\n  };\n\n  var reportErrors = function reportErrors(error) {\n    if (!error) return;\n    Alert.alert(\"Error\", error, [{\n      text: \"OK\",\n      onPress: function onPress() {\n        return console.log(\"Okey\");\n      }\n    }], {\n      cancelable: false\n    });\n  };\n\n  var logoutUser = function logoutUser() {\n    setUnauthStatus().then(function () {\n      navigation.navigate(\"ProfileTab\", {\n        screen: \"Profile\"\n      });\n    });\n  };\n\n  var list = [{\n    title: \"Basci Info\",\n    icon: \"info-outline\",\n    onPress: function onPress() {\n      navigation.navigate(\"ProfileTab\", {\n        screen: \"BasicInfo\"\n      });\n    }\n  }, {\n    title: \"Resume\",\n    icon: \"attach-file\",\n    onPress: function onPress() {\n      navigation.navigate(\"ProfileTab\", {\n        screen: \"Resume\"\n      });\n    }\n  }, {\n    title: \"Jobs Applied\",\n    icon: \"developer-board\",\n    onPress: function onPress() {\n      navigation.navigate(\"ProfileTab\", {\n        screen: \"JobsApplied\"\n      });\n    }\n  }, {\n    title: \"Change Password\",\n    icon: \"border-color\",\n    onPress: function onPress() {\n      navigation.navigate(\"ProfileTab\", {\n        screen: \"ChangePassword\"\n      });\n    }\n  }, {\n    title: \"Logout\",\n    icon: \"history\",\n    onPress: function onPress() {\n      return logoutUser();\n    }\n  }];\n  return React.createElement(ScrollView, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }\n  }, React.createElement(ImageBackground, {\n    source: {\n      uri: authUser.profile || defaultDPUri\n    },\n    style: styles.profileBg,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.profileOverlay,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 11\n    }\n  }, React.createElement(View, {\n    style: styles.profileImageWrapper,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    style: _objectSpread({}, styles.profileEditBtnWrap),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 15\n    }\n  }, React.createElement(TouchableOpacity, {\n    opacity: 1,\n    onPress: function onPress() {\n      return handleDPChange();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 17\n    }\n  }, React.createElement(View, {\n    style: _objectSpread(_objectSpread({}, styles.profileEditBtn), {}, {\n      backgroundColor: isThemeDark ? \"#ccc\" : \"#eee\"\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 19\n    }\n  }, isSubmitting ? React.createElement(ActivityIndicator, {\n    size: 24,\n    color: \"#000\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 23\n    }\n  }) : React.createElement(Icon, {\n    name: \"edit\",\n    size: 24,\n    color: \"#000\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 23\n    }\n  })))), React.createElement(Image, {\n    source: {\n      uri: authUser.profile || defaultDPUri\n    },\n    style: styles.displayPicture,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 15\n    }\n  })), React.createElement(View, {\n    style: styles.userInfo,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 13\n    }\n  }, authUser.name && React.createElement(AppText, {\n    size: 22,\n    color: \"light\",\n    family: \"semi-bold-italic\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 17\n    }\n  }, authUser.name), authUser.email && React.createElement(AppText, {\n    size: 16,\n    color: \"light\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 17\n    }\n  }, authUser.email))))), React.createElement(View, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 7\n    }\n  }, list.map(function (item, i) {\n    return React.createElement(ListItem, {\n      key: i,\n      title: item.title,\n      leftIcon: {\n        name: item.icon,\n        color: !isThemeDark ? \"#333\" : \"#fff\"\n      },\n      bottomDivider: true,\n      onPress: item.onPress,\n      containerStyle: {\n        backgroundColor: isThemeDark ? \"#000\" : \"#fff\",\n        paddingBottom: 19\n      },\n      titleStyle: {\n        color: !isThemeDark ? \"#333\" : \"#fff\"\n      },\n      pad: 25,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 11\n      }\n    });\n  })));\n}\n\nvar styles = StyleSheet.create({\n  profileBg: {\n    position: \"relative\",\n    zIndex: 1,\n    minHeight: 240,\n    resizeMode: \"contain\"\n  },\n  profileOverlay: {\n    minHeight: 240,\n    alignItems: \"center\",\n    backgroundColor: \"rgba(18,117,216,0.5)\",\n    justifyContent: \"center\"\n  },\n  profileImageWrapper: {\n    position: \"relative\"\n  },\n  profileEditBtnWrap: {\n    position: \"absolute\",\n    bottom: 8,\n    right: 2,\n    zIndex: 1\n  },\n  profileEditBtn: {\n    width: 45,\n    height: 45,\n    borderRadius: 400 / 2,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  displayPicture: {\n    height: 150,\n    width: 150,\n    borderColor: \"#ddd\",\n    borderWidth: 4,\n    borderRadius: 400 / 2\n  },\n  userInfo: {\n    alignItems: \"center\",\n    marginTop: 5\n  }\n});\nexport default User;","map":{"version":3,"sources":["/home/lekhu/Documents/David/Jobportal-Mobile-App/screens/profileStacks/user.js"],"names":["React","useState","useEffect","useContext","ThemeContext","AppText","Icon","ScrollView","TouchableOpacity","ListItem","AuthContext","ImagePicker","Constants","Permissions","Asset","Axios","images","apiPath","serializeErrors","User","navigation","isThemeDark","authUser","setUnauthStatus","updateAuthUserProfile","isSubmitting","setIsSubmitting","defaultDPUri","fromModule","defaultProfile","uri","getPermissionAsync","platform","ios","askAsync","CAMERA_ROLL","status","alert","_pickImage","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","result","cancelled","console","log","handleDPChange","then","image","photo","type","name","formData","FormData","append","_uploadDisplayPicture","user","profile","catch","err","error","response","options","method","url","data","headers","res","resp","isCancel","reportErrors","message","Alert","text","onPress","cancelable","logoutUser","navigate","screen","list","title","icon","styles","profileBg","profileOverlay","profileImageWrapper","profileEditBtnWrap","profileEditBtn","backgroundColor","displayPicture","userInfo","email","map","item","i","color","paddingBottom","StyleSheet","create","position","zIndex","minHeight","resizeMode","alignItems","justifyContent","bottom","right","width","height","borderRadius","borderColor","borderWidth","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport {\n  View,\n  Image,\n  StyleSheet,\n  ImageBackground,\n  ActivityIndicator,\n  Alert,\n} from \"react-native\";\nimport { ThemeContext } from \"../../contexts/ThemeContext\";\nimport AppText from \"../../shared/appText\";\nimport Icon from \"../../shared/icon\";\nimport { ScrollView, TouchableOpacity } from \"react-native-gesture-handler\";\nimport { ListItem } from \"react-native-elements\";\nimport { AuthContext } from \"../../contexts/AuthContext\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport Constants from \"expo-constants\";\nimport * as Permissions from \"expo-permissions\";\nimport { Asset } from \"expo-asset\";\nimport Axios from \"axios\";\nimport { images } from \"../../styles/globalStyles\";\nimport { apiPath } from \"../../utils/constants/Consts\";\nimport { serializeErrors } from \"../../utils/Helpers\";\n\nfunction User({ navigation }) {\n  const { isThemeDark } = useContext(ThemeContext);\n  const { authUser, setUnauthStatus, updateAuthUserProfile } = useContext(\n    AuthContext\n  );\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  //default display picture\n  const defaultDPUri = Asset.fromModule(images.defaultProfile).uri;\n\n  //ask for permission if ios\n  useEffect(() => {\n    getPermissionAsync();\n  }, []);\n\n\n  //ask for user permission for camera roll\n  const getPermissionAsync = async () => {\n    if (Constants.platform.ios) {\n      const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\n      if (status !== \"granted\") {\n        alert(\"Sorry, we need camera roll permissions!\");\n      }\n    }\n  };\n\n  //aync open image picker\n  const _pickImage = async () => {\n    try {\n      let result = await ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ImagePicker.MediaTypeOptions.All,\n        allowsEditing: true,\n        aspect: [1, 1],\n        quality: 1,\n      });\n      if (!result.cancelled) {\n        return result;\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  //change display picture\n  const handleDPChange = () => {\n\n    _pickImage()\n      .then((image) => {\n        setIsSubmitting(true);\n\n        let photo = {\n          uri: image.uri,\n          type: \"image/png\",\n          name: \"xyz.png\",\n        };\n\n        //use formdata\n        let formData = new FormData();\n        formData.append(\"profile\", photo);\n\n        _uploadDisplayPicture(formData)\n          .then((user) => {\n            if (!user) return;\n            updateAuthUserProfile(user.profile).then(() => {\n              alert(\"Successfully updated profile\");\n            });\n          })\n          .catch((err) => console.log(err))\n          .then(() => setIsSubmitting(false));\n      })\n      .catch(function (error) {\n        console.log(error.response);\n      });\n     \n  };\n\n  //async upload display picture\n  const _uploadDisplayPicture = async (formData) => {\n    let options = {\n      method: \"POST\",\n      url: `${apiPath}/jobseeker/edit-profile`,\n      data: formData,\n      headers: {\n        \"Accept\": \"application/json\",\n        \"Content-Type\": \"multipart/form-data;\",\n      },\n    };\n\n    try {\n      let result = await Axios(options).then((res) => res.data);\n      if (result.resp == 1) return result.user;\n    } catch (err) {\n      if (Axios.isCancel(err)) {\n        console.log(\"Request cancelled\");\n      } else if (err.response) {\n        console.log(err.response);\n\n        if (err.response.status == 422)\n          reportErrors(serializeErrors(err.response.data));\n        else if (err.response.data.resp == 0)\n          reportErrors(serializeErrors({ error: err.response.data.message }));\n        else\n          reportErrors(\n            serializeErrors({ error: \"Failed to change profile picture\" })\n          );\n      } else {\n        console.log(err);\n      }\n    }\n  };\n\n  //report errors to user\n  const reportErrors = (error) => {\n    if (!error) return;\n    Alert.alert(\n      \"Error\",\n      error,\n      [\n        { text: \"OK\", onPress: () => console.log(\"Okey\") },\n      ],\n      { cancelable: false }\n    );\n  };\n\n  //handle logout user\n  const logoutUser = () => {\n    //destroy user value\n    setUnauthStatus().then(() => {\n      //navigate to profile\n      navigation.navigate(\"ProfileTab\", {\n        screen: \"Profile\",\n      });\n    });\n  };\n\n  const list = [\n    {\n      title: \"Basci Info\",\n      icon: \"info-outline\",\n      onPress: () => {\n        navigation.navigate(\"ProfileTab\", {\n          screen: \"BasicInfo\",\n        });\n      },\n    },\n    {\n      title: \"Resume\",\n      icon: \"attach-file\",\n      onPress: () => {\n        navigation.navigate(\"ProfileTab\", {\n          screen: \"Resume\",\n        });\n      },\n    },\n    {\n      title: \"Jobs Applied\",\n      icon: \"developer-board\",\n      onPress: () => {\n        navigation.navigate(\"ProfileTab\", {\n          screen: \"JobsApplied\",\n        });\n      },\n    },\n\n    {\n      title: \"Change Password\",\n      icon: \"border-color\",\n      onPress: () => {\n        navigation.navigate(\"ProfileTab\", {\n          screen: \"ChangePassword\",\n        });\n      },\n    },\n    {\n      title: \"Logout\",\n      icon: \"history\",\n      onPress: () => logoutUser(),\n    },\n  ];\n\n  return (\n    <ScrollView>\n      {/* top content start */}\n      <View>\n        <ImageBackground\n          source={{\n            uri: authUser.profile || defaultDPUri,\n          }}\n          style={styles.profileBg}\n        >\n          {/* overlay content start */}\n          <View style={styles.profileOverlay}>\n            {/* profile image wrapper start */}\n            <View style={styles.profileImageWrapper}>\n              <View\n                style={{\n                  ...styles.profileEditBtnWrap,\n                }}\n              >\n                <TouchableOpacity opacity={1} onPress={() => handleDPChange()}>\n                  <View\n                    style={{\n                      ...styles.profileEditBtn,\n                      backgroundColor: isThemeDark ? \"#ccc\" : \"#eee\",\n                    }}\n                  >\n                    {isSubmitting ? (\n                      <ActivityIndicator size={24} color=\"#000\" />\n                    ) : (\n                      <Icon name=\"edit\" size={24} color=\"#000\" />\n                    )}\n                  </View>\n                </TouchableOpacity>\n              </View>\n\n              <Image\n                source={{\n                  uri: authUser.profile || defaultDPUri,\n                }}\n                style={styles.displayPicture}\n              />\n            </View>\n            {/* profile image wrapper end */}\n\n            {/* user info start */}\n            <View style={styles.userInfo}>\n              {authUser.name && (\n                <AppText size={22} color=\"light\" family=\"semi-bold-italic\">\n                  {authUser.name}\n                </AppText>\n              )}\n\n              {authUser.email && (\n                <AppText size={16} color=\"light\">\n                  {authUser.email}\n                </AppText>\n              )}\n            </View>\n            {/* user info end */}\n          </View>\n          {/* overlay content end */}\n        </ImageBackground>\n      </View>\n      {/* top content end */}\n\n      {/* menu list start */}\n      <View>\n        {list.map((item, i) => (\n          <ListItem\n            key={i}\n            title={item.title}\n            leftIcon={{\n              name: item.icon,\n              color: !isThemeDark ? \"#333\" : \"#fff\",\n            }}\n            bottomDivider\n            onPress={item.onPress}\n            containerStyle={{\n              backgroundColor: isThemeDark ? \"#000\" : \"#fff\",\n              paddingBottom: 19,\n            }}\n            titleStyle={{\n              color: !isThemeDark ? \"#333\" : \"#fff\",\n            }}\n            pad={25}\n          />\n        ))}\n      </View>\n      {/* menu list end */}\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  profileBg: {\n    position: \"relative\",\n    zIndex: 1,\n    minHeight: 240,\n    resizeMode: \"contain\",\n  },\n  profileOverlay: {\n    minHeight: 240,\n    alignItems: \"center\",\n    backgroundColor: \"rgba(18,117,216,0.5)\",\n    justifyContent: \"center\",\n  },\n  profileImageWrapper: {\n    position: \"relative\",\n  },\n  profileEditBtnWrap: {\n    position: \"absolute\",\n    bottom: 8,\n    right: 2,\n    zIndex: 1,\n  },\n  profileEditBtn: {\n    width: 45,\n    height: 45,\n    borderRadius: 400 / 2,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  displayPicture: {\n    height: 150,\n    width: 150,\n    borderColor: \"#ddd\",\n    borderWidth: 4,\n    borderRadius: 400 / 2,\n  },\n  userInfo: {\n    alignItems: \"center\",\n    marginTop: 5,\n  },\n});\n\nexport default User;\n"]},"metadata":{},"sourceType":"module"}